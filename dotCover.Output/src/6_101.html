<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Akanksha Wattamwar\Desktop\CS455\CS455-Assignment-1\TestProject\StateChangeTests.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using Bunit;
using Xunit;
using MoleProject.Pages;
using Moq;
using System.Net;
using System.Net.Http;
using System.Threading;
using System.Threading.Tasks;
using Moq.Protected;
using Newtonsoft.Json;

namespace WhackEmAllTests
{
    public class WhackEmAllTests : TestContext
    {
        [Fact]
        public void StartGame_ShouldInitializeGameCorrectly()
        {
            var gameService = new Game
            {
                playerName = &quot;TestPlayer&quot;
            };
            gameService.StartGame();


            Assert.Equal(0, gameService.score);
            Assert.Equal(750, gameService.gameSpeed);
            Assert.Equal(16, gameService.Cells.Count);
            Assert.True(gameService.isGameStarted);
            Assert.True(string.IsNullOrEmpty(gameService.message));
            Assert.False(gameService.showGameOverModal);
            Assert.NotNull(gameService.gameLoopTimer);
            Assert.NotNull(gameService.gameTimeTimer);
            Assert.Equal(60, gameService.currentTime);
            Assert.True(gameService.isGameRunning);
        }

        [Fact]
        public async Task EndGame_ShouldTerminateGameCorrectly()
        {
            // Arrange
            var mockGame = new Mock&lt;Game&gt;
            {
                CallBase = true // Ensures the actual logic is used except for mocked methods
            };
            mockGame.Object.playerName = &quot;TestPlayer&quot;;
            mockGame.Object.StartGame();
            mockGame.Setup(x =&gt; x.SendScoreToServer(It.IsAny&lt;int&gt;())).Returns(Task.CompletedTask); // Mock the method

            // Act
            await mockGame.Object.EndGame();

            // Assert
            Assert.False(mockGame.Object.isGameRunning);
            Assert.True(mockGame.Object.showGameOverModal);
            mockGame.Verify(x =&gt; x.SendScoreToServer(It.IsAny&lt;int&gt;()), Times.Once);
        }

        [Fact]
        public void SetNextAppearance_ShouldSetNextMoleAppearanceCorrectly()
        {
            var gameService = new Game
            {
                playerName = &quot;TestPlayer&quot;
            };

            gameService.StartGame();

            gameService.setNextAppearance();
            int currentMoleIndex = gameService.hitPosition;
            Assert.True(gameService.Cells[currentMoleIndex].IsShown);

            gameService.setNextAppearance();
            int newMoleIndex = gameService.hitPosition;

            Assert.False(gameService.Cells[currentMoleIndex].IsShown);
            Assert.True(gameService.Cells[newMoleIndex].IsShown);
        }

        [Fact]
        public void RestartGame_ResetsGameState()
        {
            var cut = RenderComponent&lt;Game&gt;();
            cut.Instance.StartGame();
            cut.Instance.playerName = &quot;TestPlayer&quot;;
            cut.Instance.EndGame();

            cut.Instance.RestartGame();

            Assert.True(cut.Instance.isGameStarted);
            Assert.True(cut.Instance.isGameRunning);
            Assert.Equal(0, cut.Instance.score);
            Assert.Equal(60, cut.Instance.currentTime);
            Assert.False(cut.Instance.showGameOverModal);
        }

        [Fact]
        public void ReturnToStartMenu_SetsCorrectState()
        {
            var cut = RenderComponent&lt;Game&gt;();
            cut.Instance.StartGame();
            cut.Instance.playerName = &quot;TestPlayer&quot;;
            cut.Instance.EndGame();

            cut.Instance.ReturnToStartMenu();

            Assert.False(cut.Instance.isGameStarted);
            Assert.False(cut.Instance.showGameOverModal);
        }

    }
}


    </pre>
    <script type="text/javascript">
      highlightRanges([[18,9,18,10,1],[19,13,22,15,1],[23,13,23,37,1],[26,13,26,48,1],[27,13,27,54,1],[28,13,28,55,1],[29,13,29,52,1],[30,13,30,68,1],[31,13,31,57,1],[32,13,32,55,1],[33,13,33,55,1],[34,13,34,55,1],[35,13,35,52,1],[36,9,36,10,1],[40,9,40,10,1],[42,13,45,15,1],[46,13,46,55,1],[47,13,47,41,1],[48,13,48,99,1],[51,13,51,45,1],[54,13,54,57,1],[55,13,55,60,1],[56,13,56,84,1],[57,9,57,10,1],[61,9,61,10,1],[62,13,65,15,1],[67,13,67,37,1],[69,13,69,45,1],[70,13,70,60,1],[71,13,71,70,1],[73,13,73,45,1],[74,13,74,56,1],[76,13,76,71,1],[77,13,77,66,1],[78,9,78,10,1],[82,9,82,10,1],[83,13,83,47,1],[84,13,84,38,1],[85,13,85,52,1],[86,13,86,36,1],[88,13,88,40,1],[90,13,90,53,1],[91,13,91,53,1],[92,13,92,49,1],[93,13,93,56,1],[94,13,94,58,1],[95,9,95,10,1],[99,9,99,10,1],[100,13,100,47,1],[101,13,101,38,1],[102,13,102,52,1],[103,13,103,36,1],[105,13,105,46,1],[107,13,107,54,1],[108,13,108,58,1],[109,9,109,10,1]]);
    </script>
  </body>
</html>